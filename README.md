# CatFeeder 2
Полная перереработка проекта [CatFeeder](https://github.com/altJSV/CatFeeder) под ESP32.

## Особенности проекта
* Цветной TFT экран с сенсорным управлением
* Часы с синхронизацией времени по NTP протоколу
* Настройки размера порции и времени кормления с 4 независимыми будильниками
* Управление по MQTT протколу для интеграции в систему умного дома
* Веб интерфейс
* Сохранение и запись настроек в файлы конфигурации

## Сборка проекта
Для сборки проекта вам понадобятся следующие компоненты:
* Любая отладочная плата на базе ESP32. Я использовал ESP32 WROOM 38 PIN
* Драйвер мотора MX1508
* Шаговый двигатель NEMA17
* Сенсорный дисплей ILI9341 с разрешением 320x240 и драйвером тача XPT2046
* Цифровой датчик веса 1кг + драйвер HX711
* Набор проводов для соединений
* Макетная плата 50х70 мм
* Несколько разъемов dupont или похожих для подключения проводов
* Источник питания минимум 5В 2А. Подойдет любая мощная USB зарядка от телефона

Далее, в соответствии со схемой, подключаем все компоненты. 
Если кто-то решит собирать на макетной плате как я, то ниже несколько более подробное описание процесса сборки с фото.
Решил не распаивать все на одной плате и сделать проект модульным, чтобы в случае каких либо проблем, просто заменить неисправный модуль на новый.
Для начала, на макетке распаял все разъемы для подключения ESP32 и домполнительных модулей. Сразу же припаял USB разъем для подключения зарядного устройства.
![Распайка разъемов](/docs/solder1.jpg)
Со подключенным ESP32 управляющая плата выглядит следующим образом.
![Подключение ESP32](/docs/solder2.jpg)
С обратной стороны платы, соединил проводами из витой пары контакты разъема ESP32 с разъемами на плате. Ниже одно из ранних фото процесса. Еще не все контакты распаяны.
![Вид сзади](/docs/solder3.jpg)
Для удобства, при пайке, можете сверяться со схемой ниже
![Схема пайки](/docs/board_pinout_ref.png)
Шлейфы, для подключения дополнительных модулей, делал из той же витой пары. На фото ниже шлейф дисплея.
![Шлейф дисплея](/docs/solder4.jpg)
После пайки платы, обязательно прозвоните все контакты мультиметром и заизолируйте все места пайки. Паяльной маской, термоклеем или тем, что у вас есть под рукой.
Два разъема питания из четырех, пока никак не задействованы и были оставлены для возможных будущих модификаций.


##Прошивка
Сборка и установка прошивки осуществляется в среде разработки Arduino IDE

###Необходимые библиотеки

Для сборки проекта вам необходимо установить дополнительные библиотеки для Arduino IDE:
* LVGL - 8.3.10
* TFT_eSPI - 2.5.0 и выше
* GyverNTP - 1.3.1
* GyverTimer - 3.2
* PubSubClient от Nick O'Leary - 2.8
* ArduinoJSON - 6.21.3



